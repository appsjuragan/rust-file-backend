@layer utilities {

    /* CommonModal */
    .rfm-modal-centered-wrapper {
        @apply absolute inset-0 flex items-center justify-center pointer-events-none z-[9000];
    }

    .rfm-modal--centered {
        @apply relative top-auto left-auto pointer-events-auto;
    }

    .rfm-modal-container {
        @apply absolute rounded-2xl bg-slate-50 z-[9000] border border-slate-200 top-[10%] left-[10%] w-[450px] h-[350px] flex flex-col overflow-hidden dark:bg-slate-900 dark:border-slate-800;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        resize: both;
    }

    /* Specific sizing for different modal types */
    .rfm-preview-modal {
        @apply w-[800px] h-[600px] max-w-[90vw] max-h-[85vh];
    }

    .rfm-metadata-modal {
        @apply w-[500px] h-auto;
    }

    .rfm-modal-container::after {
        content: "";
        @apply absolute bottom-1 right-1 w-3 h-3 border-r-2 border-b-2 border-slate-300 rounded-br-sm pointer-events-none;
    }

    .rfm-modal-header {
        @apply flex items-center justify-between px-4 py-2.5 cursor-grab active:cursor-grabbing;
        background: linear-gradient(180deg, #334155 0%, #0f172a 100%);
        border-bottom: 1px solid rgba(0, 0, 0, 0.3);
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .rfm-modal-title {
        @apply text-[11px] font-bold text-white/90 truncate pr-4 flex-1 uppercase tracking-[0.2em] antialiased;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    }

    .rfm-modal-body {
        @apply flex flex-col flex-1 min-h-0 p-5 overflow-y-auto;
    }

    /* Preview Modal Content Sizing */
    .rfm-preview-modal .rfm-modal-body {
        @apply p-0;
    }

    .rfm-preview-content {
        @apply flex-1 flex flex-col items-center justify-center overflow-hidden w-full h-full;
    }

    .rfm-preview-full {
        @apply p-0 m-0 w-full h-full;
    }

    .rfm-preview-pdf {
        @apply w-full h-full border-none;
        min-height: 100%;
    }

    .rfm-preview-image {
        @apply max-w-full max-h-full object-contain shadow-lg rounded-lg;
    }

    .rfm-preview-video {
        @apply max-w-full max-h-full shadow-lg rounded-lg;
    }

    .rfm-preview-audio {
        @apply w-[80%] max-w-[400px];
    }

    .rfm-preview-textarea {
        @apply w-full h-full p-4 font-mono text-sm bg-slate-50 dark:bg-slate-800 border-none outline-none resize-none dark:text-slate-300;
    }

    .rfm-preview-loading {
        @apply flex items-center justify-center w-full h-full text-slate-500 font-medium;
    }

    .rfm-preview-no-support {
        @apply flex flex-col items-center justify-center text-center p-10 text-slate-500;
    }

    /* ZIP Preview Styles */
    .rfm-zip-preview {
        @apply flex flex-col h-full w-full overflow-hidden;
    }

    .rfm-zip-header {
        @apply flex justify-between px-4 py-2 bg-slate-200 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 text-xs font-bold text-slate-500 uppercase tracking-wider sticky top-0;
    }

    .rfm-zip-list {
        @apply flex-1 overflow-y-auto;
    }

    .rfm-zip-entry {
        @apply flex justify-between px-4 py-2 border-b border-slate-100 dark:border-slate-800/50 hover:bg-slate-100 dark:hover:bg-slate-800/80 transition-colors;
    }

    .rfm-zip-entry.is-dir {
        @apply font-semibold text-slate-700 dark:text-slate-300;
    }

    .rfm-zip-entry-name {
        @apply flex items-center gap-2 truncate text-sm;
    }

    .rfm-zip-entry-size {
        @apply text-xs text-slate-400 font-mono;
    }

    .rfm-modal-icon {
        @apply w-8 h-8 p-1.5 flex items-center justify-center text-white cursor-pointer transition-all duration-200 rounded-lg z-[1000] relative;
        background-color: rgba(244, 63, 94, 0.8);
        /* Rose-500 with slight transparency */
        backdrop-filter: blur(4px);
        opacity: 1 !important;
    }

    .rfm-modal-icon svg {
        @apply w-5 h-5;
        fill: white !important;
    }

    .rfm-modal-icon:hover {
        @apply bg-rose-600 scale-110 rotate-90 !important;
        opacity: 1 !important;
    }

    .rfm-modal-icon:active {
        @apply scale-95 opacity-80 !important;
    }

    /* ==================== Responsive Modals ==================== */

    /* Tablet */
    @media (max-width: 1024px) {
        .rfm-modal-container {
            @apply w-[90vw] max-w-[450px];
        }

        .rfm-preview-modal {
            @apply w-[95vw] max-w-[800px] h-[70vh];
        }
    }

    /* Mobile */
    @media (max-width: 768px) {
        .rfm-modal-container {
            @apply w-[calc(100vw-1rem)] max-w-none left-2 top-[5%];
            height: auto !important;
            max-height: 90vh;
        }

        .rfm-modal-body {
            @apply p-3;
        }

        .rfm-preview-modal {
            @apply fixed inset-0 w-full h-full max-w-none max-h-none rounded-none top-0 left-0 m-0 border-0 !important;
            transform: none !important;
            z-index: 9000;
        }

        .rfm-preview-modal .rfm-modal-header {
            @apply absolute top-0 left-0 right-0 z-20 border-0 bg-gradient-to-b from-black/80 to-transparent pt-4 pb-12 px-4;
            box-shadow: none;
        }

        .rfm-preview-modal .rfm-modal-title {
            @apply text-white text-sm font-medium opacity-90;
        }

        .rfm-preview-modal .rfm-modal-body {
            @apply h-full p-0 bg-black flex items-center justify-center pt-0;
        }

        .rfm-preview-modal .rfm-modal-icon {
            @apply bg-white/20 hover:bg-white/30 rounded-full w-9 h-9 backdrop-blur-sm self-start mt-0.5 !important;
        }

        .rfm-preview-modal .rfm-modal-icon svg {
            fill: white !important;
            @apply w-5 h-5;
        }

        .rfm-preview-image {
            @apply max-h-screen w-auto max-w-full shadow-none rounded-none;
        }

        .rfm-preview-video {
            @apply max-h-screen w-full max-w-full rounded-none;
        }

        /* Adjust padding for non-media content to clear the absolute header */
        .rfm-zip-preview,
        .rfm-preview-full,
        .rfm-preview-no-support {
            padding-top: 70px !important;
        }

        .rfm-zip-list {
            @apply px-4 pb-8;
        }

        .rfm-preview-textarea {
            @apply px-4 pb-8 h-full box-border;
        }
    }

    /* Small phones */
    @media (max-width: 480px) {
        .rfm-modal-container {
            @apply left-1 w-[calc(100vw-0.5rem)];
        }

        .rfm-modal-header {
            @apply px-3 py-2;
        }

        .rfm-modal-body {
            @apply p-2;
        }
    }
}